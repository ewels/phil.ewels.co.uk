---
import BaseLayout from "../layouts/BaseLayout.astro";
import PageTitle from "@components/PageTitle.astro";

const formClasses =
  "mt-1 block w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm placeholder-slate-400 shadow-sm invalid:border-pink-500 invalid:text-pink-600 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500 focus:invalid:border-pink-500 focus:invalid:ring-pink-500 disabled:border-slate-200 disabled:bg-slate-50 disabled:text-slate-500 disabled:shadow-none dark:bg-stone-800";
---

<BaseLayout title="Contact Me">
  <PageTitle>Contact Me</PageTitle>

  <p class="mb-4">
    Feel free to drop me a line through <a href="http://twitter.com/tallphil" class="link">twitter</a>,
    <a href="http://uk.linkedin.com/in/philewels" class="link">LinkedIn</a> or similar. I also spend a lot of time on the
    <a href="https://nf-co.re/join" class="link">nf-core</a>
    and <a href="https://www.nextflow.io/slack-invite.html" class="link">Nextflow Slack channels</a>, so feel free to
    drop me a message there.
  </p>
  <p class="mb-8">
    If you prefer, you can find my email address on my
    <a rel="me" class="link" href="https://github.com/ewels/">GitHub profile</a>
    (logged-in users only).
  </p>

  <form name="contact" method="POST" netlify-honeypot="sweet-and-sticky" data-netlify="true">
    <label class="mb-8 hidden">
      <span class="block">If you're a real person, do not enter anything in this field</span>
      <input type="text" name="sweet-and-sticky" class={formClasses} />
    </label>
    <label class="mb-8 block">
      <span class="block">Name</span>
      <input type="text" name="name" class={formClasses} />
    </label>
    <label class="mb-8 block">
      <span class="block">Your e-mail address</span>
      <input type="email" name="email" class={formClasses} />
    </label>
    <label class="mb-8 block">
      <span class="block">Your message</span>
      <textarea name="message" rows="5" class={formClasses}></textarea>
    </label>
    <button id="submit-btn" type="submit" class="btn mt-8">Send email</button>
  </form>
</BaseLayout>

<script>
  const handleSubmit = (event) => {
    event.preventDefault();

    const myForm = event.target;
    const formData = new FormData(myForm);

    fetch("/", {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: new URLSearchParams(formData).toString(),
    })
      .then(() => {
        document.getElementById("submit-btn").innerHTML = "Message sent!";
        document.getElementById("submit-btn").disabled = true;
      })
      .catch((error) => alert(error));
  };

  document.querySelector("form").addEventListener("submit", handleSubmit);
</script>
